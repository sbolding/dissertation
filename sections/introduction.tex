%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  New template code for TAMU Theses and Dissertations starting Fall 2012.  
%  For more info about this template or the 
%  TAMU LaTeX User's Group, see http://www.howdy.me/.
%
%  Author: Wendy Lynn Turner 
%	 Version 1.0 
%  Last updated 8/5/2012
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                           SECTION I
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\pagestyle{plain} % No headers, just page numbers
\pagenumbering{arabic} % Arabic numerals
\setcounter{page}{1}

\chapter{\uppercase {Introduction}}

We have developed and implemented a new high-order low-order (HOLO) algorithm for solving
thermal radiative transfer (TRT) problems. This algorithm has several desirable properties
that improve on current computational methods for solving TRT
problems.  In particular, our HOLO method utilizes an exponentially-convergent Monte
Carlo (ECMC) algorithm to solve the associated radiation transport equation.  The ECMC
method significantly decreases the statistical noise associated with MC calculations to
TRT problems.  In addition, we use a nonlinear low-order (LO) system to efficiently 
resolve nonlinear dependencies in system, while preserving accuracy of the ECMC
treatment of particle transport.  The HOLO algorithm has
been developed and implemented for a simplified model with one spatial dimension and 
frequency-integrated equations.

The LO equations are formed with finite-element (FE) based spatial
moments and angular moments over each half-range.  A linear-discontinuous representation
is used to discretized the temperature field.  The LO equations are similar to S$_2$ equations,
but contain intensity-weighted angular averages that are estimated via the HO solver.    
The LO solver is fully implicit in time and efficiently resolves the non-linear
temperature dependence at each time step.  The HO transport problem is a fixed-source,
pure absorber transport problem, with sources defined by the previous LO solve.  This
transport equation is solved with ECMC simulation to produce a globally accurate solution. 
This
global solution is used to compute consistency terms, which require the HO and LO solutions to converge towards the same solution.  The use of ECMC
allows for the efficient reduction of statistical noise in the MC solution, reducing
inaccuracies introduced through the LO consistency
terms. 

We have also investigated several extensions of this method.  In particular, we have 
investigated higher time accuracy by including the time variable in the ECMC transport
algorithm.

We compare results with an
implicit Monte Carlo (IMC) code for one-dimensional, gray test problems and 
demonstrate the efficiency of ECMC over standard Monte Carlo in this HOLO algorithm.

In the remainder of this chapter, we provide a background on TRT problems, discuss
previous and related work, and then

\section{Thermal Radiative Transfer Background}

Thermal radiative transfer (TRT) physics describe the time-dependent energy distributions of a photon
radiation field and a high-temperature material.  The material and radiation exchange
energy through absorption and emission of photons by the material.  
Accurate modeling of TRT physics becomes relevant in the high-energy,
high-density physics regime.   Radiative transfer is the dominant form of heat transfer in
very high-temperature systems, where the material temperature $T$ is $O(10^6)$ K or
higher. Typical computational applications of TRT include simulation of inertial confinement fusion and
astrophysics phenomena.  

 The transport of photons through a material is characterized by particle position, direction, and
frequency.  The material energy distribution is described by the material internal
energy as a function of position.  The high-dimensional space results in a nonlinear
transport problem that is difficult to solve.
The internal energy $e$ is related to the material
temperature through an equation of state.  In this work a perfect gas equation of state is
used~\cite{toro}, which produces the relation $\rho c_v T = e$, where $\rho$ is the
material mass density and $c_v$ is the specific heat.  Thus, we will now discribe the
equations in terms of temperature.

The governing equations for thermal radiative transfer problems are the radiation and material
 energy balance equations:
 \begin{align}
     \frac{1}{c} \pderiv{I\phsp}{t} + \mathbf{\Omega}\cdot \Del I \phsp + \sigma_t
     (\mathbf{r},\nu) I \phsp 
 \end{align}

The following additional assumptions were made in the derivation of the above equations: photons are treated as point
particles, the ion states are in local thermodynamic equilibrium~\cite{mihalis}

    The equations are
strongly coupled through the gray Planckian emission source $\sigma_a a c T^4$, which
is a nonlinear function of temperature, and the radiation absorption
term $\sigma_a \phi$.  In general, the material properties are a function of $T$.  The
temperature-dependent material properties and
absorption and reemission physics lead to systems that require accurate modeling of
photon transport through a  mix of
streaming and optically-thick, diffusive regions.  Although in most physical
applications material motion is present, it is not the focus of this research and will not
be considered.  The purpose of the proposed research is to demonstrate the ability 
of a new algorithm to provide highly-accurate and efficient solutions to
Eq.~\eqref{eq:rad_cont} and Eq.~\eqref{eq:mat_cont}.

\subsection{Derivation of 1D Grey Model}

The transport of photons through a material is governed by the Boltzmann linear transport
equation~\cite{shultis_mc,lewis}.  We have demonstrated our method by applying it to a
simplified model.  make an assumption of isotropic scattering to
simplify the equations.  The radiative 

This research will focus on a simplified 1D slab-geometry and
 frequency-integrated (grey) TRT model.  The governing equations for this simplified model are the radiation and material
 energy balance equations
\begin{align}\label{eq:rad_cont}
    \frac{1}{c}\pderiv{I(x,\mu,t)}{t} + \mu \pderiv{I(x,\mu,t)}{x} + \sigma_t
    I(x,\mu,t)
&= \frac{\sigma_s}{2} \phi(x,t) +\frac{1}{2} \sigma_a a c T^4(x,t)
    \\ \label{eq:mat_cont}
  \rho c_v \pderiv{T(x,t)}{t} &=  \sigma_a \phi(x,t) - \sigma_a a c T^4(x,t).
\end{align}
In the above equations the fundamental unknowns are the material temperature $T(x,t)$ and
the angular intensity $I(x,\mu,t)$ of radiation, where $x$ is the position, $t$ is the time, $\mu$ is
the $x$-direction cosine of the photon direction of travel, and $a$, $c$, $\rho$,
and
$c_v$ are the radiation constant, speed of light, material mass density, and material specific heat; $\sigma_a$, $\sigma_s$, and
$\sigma_t$ are the absorption, scattering, and total
cross sections (cm$^{-1}$), respectively.  The scalar radiation intensity $\phi(x,t)=\int_{-1}^1
I(x,\mu,t) \dd \mu$ is related to the radiation energy density
$E$ (with typical units Jks cm$^{-3}$ sh$^{-1}$) by the relation $E = \phi/c$.

\subsection{The Monte Carlo method for Particle Transport}


\section{Previous Work}

This sections describes related work on Monte Carlo solution to the TRT equations.  The
Monte Carlo (MC) method samples the underlying physics distributions to estimate the
average behavior of a field of photon.  This can provide a highly-accurate results, in
particular for treatement of the angular and temporal variable in the transport equation.  The
temperature equation is almost always solved deterministically in such particle transport
methods. Monte carlo solution to the transport equation can introduce larege statistical
noise into the material temperature distribution, which is undesirable when coupling to
other physics.  To improve the efficiency of MC solutions, hybrid MC methods utilize a
deterministic solution to accelerate the MC solution.  

\subsection{The Implicit Monte Carlo Method}

Monte Carlo (MC) solution to the TRT equations is typically achieved by the 
implicit Monte Carlo (IMC) method~\cite{fnc}. This
method partially linearizes Eq.~\eqref{eq:rad_cont} \& Eq.~\eqref{eq:mat_cont} over a discrete time
step, with material properties evaluated at the previous temperature.  Linearization of
the system produces a transport equation that contains an approximate emission source and
an effective scattering cross section representing absorption and reemission of photons
over a time step. This transport equation is advanced over a time step via MC. The MC
simulation tallies energy absorption over a discretized spatial mesh.  The energy
absorption in each mesh cell is used to directly estimate a new end of time step
temperature in that cell.  In optically thick regions, or for large time steps, the
effective scattering dominates interactions.  In these diffusive regions IMC becomes
computationally expensive. Acceleration methods typically attempt to improve efficiency by
allowing particles to take discrete steps through optically thick regions based on a
discretized diffusion approximation~\cite{imd,ddmc}.  In IMC the approximate linearization
of the emission source is not iterated on within a time step due to the large
computational cost of the MC transport each time step; this imposes a limit on the time
step size to produce physically accurate results~\cite{wollaber2013discrete}. 

The Monte Carlo (MC) method~\cite{shultis_mc} is a standard computational method in
the field of radiation transport.
 The implicit Monte Carlo (IMC) method~\cite{fnc}
is the most common approach for applying the MC method to TRT problems. The IMC
method partially linearizes Eq.~\eqref{eq:rad_cont} and Eq.~\eqref{eq:mat_cont} over a discrete time
step and lags material properties to produce a linear transport equation, which can be solved with MC
simulation.  The linear transport equation contains an approximate emission source
and effective scattering cross section that represent
absorption and reemission of photons over a time step.  The transport equation is
solved with MC simulation 
to advance the distribution of radiation to the end of the time step and determine
the energy absorbed by the material over the time step.  The energy absorption by
the material is tallied over a discrete spatial mesh, computed with cell-averaged
quantities.
  The energy absorption in each mesh cell is used to directly estimate
a new end of time step material temperature based on the linearized material
energy balance equation. Integration of the
time-variable is treated continuously over the time step via MC sampling, but the
linearized Planckian source in the transport equation is based on a time-discrete
approximation.
  

The IMC method has some limitations.  In optically thick regions, or for
large time steps, the
effective scattering dominates interactions.  In these diffusive regions IMC
becomes computationally expensive. Acceleration methods typically attempt to improve
efficiency by allowing particles to take discrete steps through optically-thick
regions based on a spatially-discretized diffusion approximation~\cite{imd,ddmc}. 
Another issue occurs due to the approximate linearization of the system which can not
be iteratively improved due
to the high computational cost of the MC transport.  For some problems, the
linearization can yield non-physical results that violate the discrete maximum
principle if the time step size is too large or the cell size is too
small~\cite{wollaber2013discrete}.  The violation of the maximum principle results in
the material temperature being artificially higher than the boundary conditions and
sources should physically allow.  The violation is caused by the temperature in the
emission source not being fully implicit in time due to the necessary linearization.
The work in~\cite{iimc_gentile} uses less-expensive MC iterations to produce an implicit system
which prevents this from happening, but has very slow iterative convergence in diffusive
problems.  
In IMC, temperature-dependent
material properties, in particular cross sections, are evaluated at the previous-time
step temperature. These lagged cross sections can produce inaccurate solutions but
do not cause stability issues.  


In IMC the material and radiation energy fields are discretized spatially to solve for cell-averaged values.
Inaccurate spatial representation of the emission source over a cell can result in
energy propagating through the domain artificially fast, yielding non-physical
results referred to as ``teleportation error"~\cite{teleportation}.  The IMC method uses a fixup known as source tilting
to mitigate this problem.  Source tilting reconstructs a more accurate
linear-discontinuous representation of the
emission source within a cell based on the cell-averaged material temperatures in adjacent
cells.  Recent work in IMC has incorporated a linear-discontinuous finite-element representation directly into 
the discretization of the material temperature equation~\cite{wollaeger_ld}.

%PICTURE OF STANDARD MC SOLUTION AND MAXIMUM PRINCIPLE VIOLATION?

%WHAT IS UP WITH THE WEIRD DIFFUSION LIMIT

For TRT simulations, inaccurate spatial representation of the emission source over a cell can result in
energy propagating through the domain artificially fast, yielding non-physical
results referred to as ``teleportation error"~\cite{teleportation}.  The IMC method uses a fixup known as source tilting
to mitigate this problem.  Source tilting reconstructs a more accurate
linear-discontinuous representation of the
emission source within a cell based on the cell-averaged material temperatures in adjacent
cells. This linear reconstruction is also necessary to preserve the asymptotic equilibrium diffusion
limit (EDL), at least for a more general time step size and class of problems than for a piece-wise constant representation~\cite{diff_limit_imc}.  Preserving the equilibrium diffusion limit is an
important aspect of a numerical method for TRT problems. 
In this limit, cells are optically thick and diffusive, and the material
and radiation energy fields approach equilibrium.
Spatial discretizations which do not preserve the EDL can produce inaccurate
solutions, even though the mesh size should accurately capture the behavior of the solution~\cite{morel_ldtrt}.

\subsection{Previous work on moment-based acceleration methods}

An alternative application of MC to the TRT equations is moment-based hybrid MC methods.
Recent work has focused on so-called high-order low-order (HOLO)
methods~\cite{willert,park,rmc,ans_2014}. These methods involve fixed-point
iterations between high-order (HO) MC solution of a transport equation and a deterministic LO
system.  The low-order (LO)
operator is based on angular moments of the transport equation, formulated over a fixed
spatial mesh.  Physics operators that are time consuming for MC
to resolve, e.g., absorption-reemission physics, are moved to the LO
system.  The reduced angular dimensionality of the system and Newton methods allow for non-linearities in the LO equations to be fully
resolved efficiently~\cite{willert,park}.  The high-order (HO) transport problem is defined by 
Eq.~\eqref{eq:rad_cont}, with sources estimated from the previous LO solution.  
The high-order (HO) transport equation is solved via MC to produce a high-fidelity solution for
the angular intensity.  The MC estimate of the angular intensity is used to estimate
consistency terms,
present in the LO equations, that require the LO system to preserve the angular accuracy of the
MC solution.   
These consistency terms are present in all spatial-regions of the problem, requiring
statistical variance to be reduced sufficiently throughout the entire domain of the
problem. 

Another area of related research is the application of
residual Monte Carlo.  The goal of these methods is to solve an auxiliary transport
equation for the error in some estimate of the intensity.  The error is then added to the
estimate of the solution, which can produce an overall solution for the intensity that has
less statistical noise than solution of the original transport equation would produce.  In~\cite{rmc}, the MC simulation
solves for the change in intensity from the previous time step. This has the potential to limit statistical noise
significantly in regions where the solution is near equilibrium.
The work in~\cite{rmc} used residual MC as a HO solver for 1D grey problems. The
  residual MC demonstrated impressive reduction in statistical variance.
  However, a piecewise constant representation was used for the
space-angle representation of the intensity, which
does not preserve the EDL and can be inaccurate in angularly complex regions of the
problem.  Similar to RMC, a difference formulation has been applied to another algorithm known as the symbolic IMC method
(SIMC), for the case of 1D frequency-dependent problems~\cite{simc_const}.  SIMC forms a
standard FE solution to the material energy balance equation, and uses symbolic
weights in the MC transport to solve for expansion coefficents.  The difference
formulation modifies the transport equation to solve for unknowns representing the
deviation of the intensity from
equilibrium with the material energy.  The difference
formulation was also applied to a linear-discontinuous FE spatial
representation of the emission source, demonstrating accuracy in the EDL~\cite{simc}. 
Both~\cite{simc_const} and~\cite{rmc} produced minimal
statistical noise in slowly varying problems where the behavior of the system is near
equilibrium. 

\section{Overview of the HOLO Algorithm}

The research proposed herein provides a new HOLO algorithm for radiative transfer.
In this work, we propose an S$_2$-like LO operator~\cite{wolters}
in conjunction with an exponentially-convergent MC (ECMC) method~\cite{jake} for the
HO solver. Our LO system and approach to enforcing consistency contrast greatly from the typical formulation
in~\cite{rmc,willert,park}. We have derived the LO operator directly from the transport
equation, using a linear-discontinuous finite-element (LDFE) spatial
discretization.   
Exponentially-convergent Monte Carlo (ECMC)\cite{jake,ans_2014} provides an iterative algorithm that can efficiently
reduce statistical noise to acceptable levels with
significantly less particle histories than standard MC. In particular, ECMC is
exceptionally efficient in time-dependent TRT problems because information about the
intensity from the previous time step can be used as an accurate initial guess for
the new end of time step intensity.   However, implementation
of ECMC is non-trivial, requiring a finite-element representation of the solution in
all phase-space variables that are being sampled with MC.  
The method contains many of the desired qualities, such as
preserving the equilibrium diffusion limit, preserving the maximum principle, and in
particular, providing high-fidelity MC solution to the TRT equations in an efficient
manner.

Sufficient MC histories must be performed to eliminate statistical
noise in the consistency terms that can contaminate the LO solution.
Exponentially-convergent Monte Carlo (ECMC)\cite{jake,ans_2014} provides an algorithm that can efficiently
reduce statistical noise to the same order as the HOLO iteration error with
significantly less particle histories than standard MC. In particular, ECMC is
exceptionally efficient in time-dependent TRT problems because information about the
intensity from the previous time step can be used as an accurate initial guess for
the new end of time step intensity. Additionally, no particle histories are required
in regions where the radiation and material energy field are in equilibrium, similar to~\cite{rmc}.  However, implementation
of ECMC is non-trivial, requiring a finite-element representation of the solution in
all phase-space variables that are being sampled with MC.  The fundamental transport of particles is the same
as standard Monte Carlo transport codes, but the source will now contain positive and
negative weight particles.

\subsection{Similarities to Residual Monte Carlo}

Our ECMC solver contains similarities to the residual Monte Carlo (RMC) HO solver
in~\cite{rmc}, with some key differences.  The RMC algorithm uses a particular, fixed 
estimate of the solution to significantly reduce the statistical noise in the
simulation compared to a standard MC simulation. The guess for the solution is chosen to produce only sources on the faces of
cells, reducing the dimension of the phase-space to be sampled~\cite{rmc}. The RMC
algorithm  uses a piecewise constant trial space representation for the intensity in
$x$ and $\mu$.
The primary difference between the methods is that ECMC iteratively estimates the
solution, in batches, producing a known MC estimate
of the error in that estimate.  The ECMC algorithm projects the intensity onto a linear-discontinuous
finite-element (LDFE) trial space, although the RMC
algorithm could similarly be formulated with an LDFE representation.  Adaptive
mesh-refinement can be used in ECMC to produce highly accurate solutions with minimal
statistical noise, as long as sufficient particle histories are performed. 
The formulation of the residual in~\cite{rmc} use an estimate of the solution such
that only face sources need to be sampled.  This residual formulation can produce minimal
statistical noise in slowly varying problems where the behavior of the system is near
equilibrium. Our ECMC algorithm has similar statistical efficiency by choosing the previous time step intensity as the initial guess to
the algorithm; however, a linear volumetric source must be sampled in addition to face
sources.  The ECMC algorithm will generally be more efficient in cases where
the solution varies greatly over a time step or when very low statistical noise is
desired.  Generally, the minimum number of histories per batch to obtain convergence with the
LDFE trial space is larger than a piece-wise constant representation because additional
histories are needed to sufficiently estimate the first moment in $x$ and $\mu$ of the
intensity. 
It is noted that our formulation of the LO
equations and consistency terms contrast greatly from the typical formulation
in~\cite{rmc,willert,park}.  

In this work, we demonstrate the utility of an S$_2$-like LO operator~\cite{wolters}
in conjunction with an ECMC method~\cite{jake} for the HO solver.
The ECMC algorithm uses information about the intensity from the previous time step to reduce statistical noise to the same order as
the HOLO iteration error with significantly less particle histories than standard MC
simulations, with less computational cost than IMC per history.  We have derived the LO operator directly from the transport
equation, using a linear-discontinuous (LD) finite-element (FE) spatial
discretization for the HO and LO solutions. Herein we describe the algorithm and
present results for 1D, gray test problems.

\section{Dissertation Layout}

This document describes dissertation research over a new Monte Carlo algorithm for solution of
thermal radiative
transfer problems. Herein, a brief description of thermal radiative transfer and the
model problem are given, followed by a discussion of the standard Monte Carlo
solution method and other related research.  An overview of the methodology and
results performed thus far are given in Sec.~\ref{sec:perf}. Then, the remaining topics for completing this dissertation research
are discussed in Sec.~\ref{sec:prop}.  Finally, Sec.~\ref{sec:summary} provides a specific outline of the remaining research to be
investigated and computational results to be generated.


